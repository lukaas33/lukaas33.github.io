<!DOCTYPE html>
<html lang="en">
<head>
	<title>Picturer</title>
	<meta name="Picturer" content="Make a profile picture. By Lucas van Osenbruggen">
	<!-- http://realfavicongenerator.net -->
	<link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" href="favicon/favicon-32x32.png" sizes="32x32">
	<link rel="icon" type="image/png" href="favicon/favicon-16x16.png" sizes="16x16">
	<link rel="manifest" href="favicon/manifest.json">
	<link rel="mask-icon" href="favicon/safari-pinned-tab.svg" color="#5bbad5">
	<link rel="shortcut icon" href="favicon/favicon.ico">
	<meta name="msapplication-config" content="favicon/browserconfig.xml">
	<meta name="theme-color" content="#78909c">
	<!-- Load the Paper.js library -->
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/paper.js/0.10.2/paper-full.js"></script>
	<!-- Load the jQuery library -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
	<!-- Font -->
	<link href="https://fonts.googleapis.com/css?family=Noto+Sans" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

	<!--  Code -->
	<script type="text/paperscript" canvas="canvas">
		paper.install(window); // No accessing through the paper object

		// These need to be global and can be setup before the document is ready
		var selectedColor;
		var inputIsChar = true;
		var inputText;
		var drawCircle = true;
		var textOpacity = false;
		var font = "sans-serif";
		var colors =
		[
			[["#f44336", "#d32f2f"], "red"],
			[["#e91e63", "#c2185b"], "pink"],
			[["#9c27b0", "#7b1fa2"], "purple"],
			[["#673ab7", "#512da8"], "deepPurple"],
			[["#3f51b5", "#303f9f"], "indigo"],
			[["#2196f3", "#1976d2"], "blue"],
			[["#03a9f4", "#0288d1"], "lightBlue"],
			[["#00bcd4", "#0097a7"], "cyan"],
			[["#009688", "#00796b"], "teal"],
			[["#4caf50", "#388e3c"], "green"],
			[["#8bc34a", "#689f38"], "lightGreen"],
			[["#cddc39", "#afb42b"], "lime"],
			[["#ffeb3b", "#fbc02d"], "yellow"],
			[["#ffc107", "#ffa000"], "amber"],
			[["#ff9800", "#f57c00"], "orange"],
			[["#ff5722", "#e64a19"], "deepOrange"],
			[["#795548", "#5d4037"], "brown"],
			[["#9e9e9e", "#757575"], "grey"],
			[["#607d8b", "#455a64"], "blueGrey"]
		];

		$(document).ready(function()
		{
			var canvas = $('#canvas');

			var $colors =
			[
				$(".red"),
				$(".pink"),
				$(".purple"),
				$(".deepPurple"),
				$(".indigo"),
				$(".blue"),
				$(".lightBlue"),
				$(".cyan"),
				$(".teal"),
				$(".green"),
				$(".lightGreen"),
				$(".lime"),
				$(".yellow"),
				$(".amber"),
				$(".orange"),
				$(".deepOrange"),
				$(".brown"),
				$(".grey"),
				$(".blueGrey")
			];

			// Initial setup is random
			var letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("");
			inputText = letters[Math.round(Math.random() * (letters.length - 1))];
			selectedColor = Math.floor(Math.random() * colors.length);

			// --- Select colors ---
			var $color = $(".color");
			$color.click(function()
			{
				for (var i = 0; i < colors.length; i++)
				{
					if (!$(this).hasClass("selected"))
					{
						if ($(this).hasClass(colors[i][1]))
						{
							selectedColor = i;
							console.log("You selected num " + selectedColor + ": " + colors[i][1]);
							applySelection();
							drawCanvas();
						}
					}
				}
			});

			// Change view of colors
			var $forward = $(".forward");
			$forward.click(function() // Go right
			{
				scroll(-70);
			});
			var $back = $(".back");
			$back.click(function() // Go left
			{
				scroll(70);
			});

			// Bottoms visiblily
			function isVisible()
			{
				if ($(".colors ul").css("left") == "0px") // Min
				{
					$back.attr("disabled", true);
					$back .css({visibility: "hidden"});
				}
				else
				{
					$back.attr("disabled", false);
					$back .css({visibility: "visible"});
				}
				if ($(".colors ul").css("left") == "-1050px") // Max
				{
					$forward.attr("disabled", true);
					$forward .css({visibility: "hidden"});
				}
				else
				{
					$forward.attr("disabled", false);
					$forward .css({visibility: "visible"});
				}
			};

			// Scolling
			var $colorbox = $(".colors ul");
			var $bothButton = $(".arrow");
			function scroll(dir)
			{
				$bothButton.attr("disabled", true);
				var boxX = $(".colors ul").css("left");
				var newX = (Number(boxX.replace(/[^-\d\.]/g, '')) + dir) + "px";
				console.log("Scroll to " + newX);
				$colorbox.animate
				(
					{left: newX},
					{
						duration: 200,
						complete: function()
						{
							$bothButton.attr("disabled", false); // Can be clicked again after complete
							isVisible();
						}
					}
				);
			};

			// Shows if colors are selected
			function applySelection()
			{
				var selection = $colors[selectedColor]
				$(".selected").children().empty();
				$(".selected").removeClass("selected");
				selection.children().text("check");
				selection.addClass("selected");
			};

			// --- Select font ---
			var $font = $('.font');
			$font.change(function()
			{
				font = $font.val();
				console.log("You selected " + font);
				drawCanvas();
			});

			// Symbol or icon
			var	$contains = $(".contains");
			$contains.click(function()
			{
				if 	($(this).hasClass("charContainer"))
				{
					$(".iconContainer").addClass("inactive");
					$(".charContainer").removeClass("inactive");
					$font.attr("disabled", false);
					inputIsChar = true;
					font = $font.val();
					inputText = $text.val().toUpperCase();
					console.log("You selected " + inputText);
					drawCanvas();
				}
				else
				{
					$(".iconContainer").removeClass("inactive");
					$(".charContainer").addClass("inactive");
					$font.attr("disabled", true);
					inputIsChar = false;
					font = "material icons";
					inputText = $icon.val();
					console.log("You selected an icon");
					drawCanvas();
				}
			});

			// --- Text input ---
			var $text = $('.text');
			$text.val(inputText) ;
			$text.change(function()
			{
				inputText = $text.val().toUpperCase();
				console.log("You selected " + inputText);
				drawCanvas();
			});

			// --- Select icon ---
			var $icon = $(".icon");
			$icon.change(function()
			{
				inputText = $icon.val();
				console.log("You selected an icon");
				drawCanvas();
			});

			// --- Options ---
			// Checks and unchecks
			var $checkbox = $(".checkbox");
			$checkbox.click(function()
			{
				if ($(this).hasClass("checked"))
				{
					$(this).removeClass("checked");
					$(this).find("i").text("check_box_outline_blank");
					check();
				}
				else
				{
					$(this).addClass("checked");
					$(this).find("i").text("check_box");
					check();
				}
			});

			// Checks changes in options
			function check()
			{
				// Inner circle
				if ($("#circle").hasClass("checked"))
				{
					console.log("Check circle");
					drawCircle = true;
				}
				else
				{
					console.log("Uncheck circle");
					drawCircle = false;
				}
				// Partly transparent symbol
				if ($("#textOpacity").hasClass("checked"))
				{
					console.log("Check textOpacity");
					textOpacity = true;
				}
				else
				{
					console.log("Uncheck textOpacity");
					textOpacity = false;
				}
				drawCanvas();
			};

			// --- Download ---
			var $fab = $(".fab");
			$fab.click(function()
			{
				var name = (colors[selectedColor][1] + "-" + inputText + ".jpg");
				download($fab[0], name);
			});

			function download(link, name)
			{
				link.href  = canvas[0].toDataURL("image/jpeg"); // Location of new image
				link.download = name;
				console.log("Downloading...");
			};

			// --- Draw ---
			function drawCanvas()
			{
				console.log("Drawing canvas...");

				paper.setup(canvas[0]); // Only acceps DOM objects
				var canHeight = view.viewSize.height; // Height of canvas

				// Background
				var background = new Path.Rectangle([0, 0], [canHeight, canHeight]); // Fullscreen
				background.fillColor = colors[selectedColor][0][0];

				// Inner circle
				if (drawCircle)
				{
					var innerCircle = new Path.Circle(view.center, (canHeight * 0.80) / 2);
					innerCircle.fillColor = colors[selectedColor][0][1];
				}

				// Contains symbol
				var container = new Path.Rectangle(
				{
					size: canHeight * 0.6,
					point: [view.center.x - canHeight * 0.6 / 2 , view.center.y - canHeight * 0.6 / 2 ],
				});
				// Symbol
				var color = new Color(255, 255, 255, 0.95);
				if (textOpacity)
				{
					color = new Color(255, 255, 255, 0.65);
				}
				var centerText = new PointText(
				{
					content: inputText,
					fillColor: color,
					justification: "center",
					fontFamily: font
				});
				centerText.fitBounds(container.bounds); // As big as the rectangle
				if (inputIsChar)
				{
					centerText.position.y += 25;
				}
				else
				{
					centerText.position.y += 75;
				}
			};

			// Redraw when resized
			view.onResize = function(event)
			{
				setTimeout(drawCanvas(), 1500);
			};

			// Initial setup finish
			drawCanvas();
			applySelection();
			isVisible()

			// Welcome
			console.log("-- Welcome to picturer --");
			console.log("-- There are currently more than " + (colors.length * (26 + 20) * $font.children().length * 2 * 2 + colors.length * $icon.children().length * 2 * 2) + " possible combinations that can be made --");
		});
	</script>

	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box; /* Fixes box sizing problem */
			font-family: 'Noto Sans', sans-serif;
			-webkit-user-select: none;
			-webkit-touch-callout: none;
		}
		:focus, :active {
			outline: none;
		}
		::-webkit-scrollbar {
			display: none;
		}
		body {
			margin: 0;
			padding: 0;
			height: 100%;
			background-color: #eeeeee;
			color: #212121; /* Standard text color */
		}
		box {
			height: 10vh;
		}
		header {
			padding: 25px;
			position: relative;
			z-index: 10;
			background-color: #607d8b;
			box-shadow: 0px 6px 8px rgba(0,0,0,0.15);
		}
		h1 {
			vertical-align: middle;
			color: rgba(255, 255, 255, 0.95);
			font-weight: normal;
		}
		button, a {
			cursor: pointer;
			border: none;
		}
		.sidebar {
			padding: 40px;
			float: right;
			position: relative;
			display: inline-block;
			width: 25vw;
			height: 90vh;
			background-color: #fafafa;
			box-shadow: -2px 0px 10px rgba(0,0,0,0.10);
		}
		.sidebar hr {
			margin: 20px 0px;
			clear: both;
			background-color: #BDBDBD;
		}
		.screen {
			height: 90vh;
			width: 60vw;
			margin: auto;
			padding: 5vh;
			position: relative;
		}
		.container {
			width: 75vw;
			display: inline-block;
			position: relative;
			float: left;
		}
		.canvas {
			z-index: 6;
			margin: auto;
			height: 80vh;
			width: 80vh;
			display: block;
			background-color: #ffffff;
			box-shadow: 0px 2px 6px rgba(0,0,0,0.25);
			transition: 0.4s;
		}
		.canvas:hover {
			box-shadow: 0px 6px 10px rgba(0,0,0,0.30);
		}
		canvas {
			z-index: 8;
		}
		canvas[resize] { /* canvas fills .canvas */
			width: 100%;
			height: 100%;
		}
		.selectColor {
			width: auto;
		}
		.arrow {
			display: inline-block;
			width: 8%;
			position: relative;
			height: 60px;
			background-color: transparent;
			color: rgba(0, 0, 0, 0.55);
		}
		.back {
			float: left;
			visibility: hidden;
		}
		.forward {
			float: right;
		}
		.text {
			text-transform: uppercase;
			border: 1px solid #e0e0e0;
			padding: 5px;
		}
		.font {
			border: 1px solid #e0e0e0;
			padding: 5px;
		}
		.icon {
			border: 1px solid #e0e0e0;
			padding: 5px;
		}
		.checkbox {
			background-color: transparent;
			width: 100%;
			text-align: left;
			font-size: 16px;
		}
		.checkbox i {
			float: right;
			font-size: 28px;
			color: #bdbdbd;
			transition: 0.4s;
		}
		.checkbox.checked i {
			color: #FF5252;
		}
		.inactive, .inactive select, .inactive input {
			color: #9e9e9e;
		}
		.colors {
			display: inline-block;
			position: relative;
			height: 60px;
			overflow: hidden;
			width: 100%;
		}
		.colors li {
			display: inline;
			float: left;
		}
		.colors ul {
			position: relative;
			width: 1330px
		}
		.selectBox {
			width: 84%;
			display: inline-block;
		}
		.color {
			cursor: pointer;
			width: 40px;
			margin: 10px 15px;
			height: 40px;
			border-radius: 100%;
		}
		.color i {
			color: rgba(255, 255, 255, 0.85);
			margin: 7.5px;
		}
		.red { background-color: #f44336; }
		.pink { background-color: #e91e63; }
		.purple { background-color: #9c27b0; }
		.deepPurple { background-color: #673ab7; }
		.indigo { background-color: #3f51b5; }
		.blue { background-color: #2196f3; }
		.lightBlue { background-color: #03a9f4; }
		.cyan { background-color: #00bcd4; }
		.teal { background-color: #009688; }
		.green { background-color: #8bc34a; }
		.lightGreen { background-color: #cddc39; }
		.lime { background-color: #ffeb3b; }
		.yellow { background-color: #ffc107; }
		.amber { background-color: #ff9800; }
		.orange { background-color: #ff9800; }
		.deepOrange { background-color: #ff5722; }
		.brown { background-color: #795548; }
		.grey { background-color: #9e9e9e; }
		.blueGrey { background-color: #607d8b; }
		.fab {
			border-radius: 100%;
			background-color: #FF5252;
			width: 60px;
			height: 60px;
			padding: 15px;
			transition: 0.4s;
			box-shadow: 0px 4px 4px rgba(0, 0, 0, 0.15);
			position: absolute;
			bottom: 50px;
			right: 23.25vw;
			z-index: 8;
		}
		.fab:hover {
			box-shadow: 0px 6px 8px rgba(0, 0, 0, 0.25);
		}
		.fab i {
			color: rgba(255, 255, 255, 0.85);
			font-size: 30px;
		}
		footer {
			width: 100%;
			text-align: center;
			color: #bdbdbd;
			position: absolute;
			bottom: 0px;
			right: 0px;
			padding: 25px;
		}
		footer a {
			color: #bdbdbd;
			text-decoration: none;
		}
		footer a:hover {
			text-decoration: underline;
		}
	</style>
</head>
<body>
	<div class="box">
		<header>
			<h1>Picturer</h1>
		</header>
	</div>
	<div class="container">
		<div class="screen">
			<div class="canvas">
				<canvas id="canvas" resize="true"  keepalive="true"></canvas>
			</div>
		</div>
	</div>
	<div class="sidebar">
		<div class="selectColor">
			<button class="arrow back">
				<i class="material-icons"> keyboard_arrow_left </i>
			</button>
			<div class="selectBox">
				<div class="colors">
					<ul>
						<li><div class="color red"><i class="material-icons">  </i></div></li>
						<li><div class="color pink"><i class="material-icons">  </i></div></li>
						<li><div class="color purple"><i class="material-icons">  </i></div></li>
						<li><div class="color deepPurple"><i class="material-icons">  </i></div></li>
						<li><div class="color indigo"><i class="material-icons">  </i></div></li>
						<li><div class="color blue"><i class="material-icons">  </i></div></li>
						<li><div class="color lightBlue"><i class="material-icons">  </i></div></li>
						<li><div class="color cyan"><i class="material-icons">  </i></div></li>
						<li><div class="color teal"><i class="material-icons">  </i></div></li>
						<li><div class="color green"><i class="material-icons">  </i></div></li>
						<li><div class="color lightGreen"><i class="material-icons">  </i></div></li>
						<li><div class="color lime"><i class="material-icons">  </i></div></li>
						<li><div class="color yellow"><i class="material-icons">  </i></div></li>
						<li><div class="color amber"><i class="material-icons">  </i></div></li>
						<li><div class="color orange"><i class="material-icons">  </i></div></li>
						<li><div class="color deepOrange"><i class="material-icons">  </i></div></li>
						<li><div class="color brown"><i class="material-icons">  </i></div></li>
						<li><div class="color grey"><i class="material-icons">  </i></div></li>
						<li><div class="color blueGrey"><i class="material-icons">  </i></div></li>
					</ul>
				</div>
			</div>
			<button class="arrow forward">
				<i class="material-icons"> keyboard_arrow_right </i>
			</button>
		</div>
		<hr/>
		<div class="selectOptions">
			<button id="circle" class="checkbox checked"> Inner circle <i class="material-icons"> check_box </i></button><br/>
			<br/>
			<button id="textOpacity" class="checkbox"> Partly transparent <i class="material-icons"> check_box_outline_blank </i></button><br/>
		</div>
		<hr/>
		<div class="selectText">
			<div class="contains charContainer">
				<p>Symbol</p>
				<br/>
				<input class="text" type="text" maxlength="1" ></input><br/>
			<br/>
				<p>Font</p>
				<br/>
				<select class="font">
					<option value="sans-serif">Sans Serif</option>
					<option value="noto sans">Noto Sans</option>
					<option value="comic sans ms">Comic Sans</option>
					<option value="times new roman">Times new Roman</option>
				</select><br/>
			</div>
			<hr/>
			<div class="contains iconContainer inactive">
				<p>Icon</p>
				<br/>
				<select class="icon">
					<option value="fingerprint">Fingerprint</option>
					<option value="favorite">Heart</option>
					<option value="pets">Paw</option>
					<option value="flash_on">Lightning</option>
					<option value="star">Star</option>
					<option value="whatshot">Fire</option>
					<option value="cake">Cake</option>
					<option value="mood">Happy face</option>
					<option value="sentiment_neutral">Neutral face</option>
					<option value="sentiment_dissatisfied">Sad face</option>
					<option value="free_breakfast">Coffee</option>
					<option value="fitness_center">Weight</option>
					<option value="casino">Dice</option>
					<option value="drive_eta">Car</option>
					<option value="local_florist">Flower</option>
					<option value="restaurant">Eat</option>
					<option value="cloud">Cloud</option>
					<option value="visibility">Eye</option>
					<option value="thumb_up">Thumb up</option>
					<option value="thumb_down">Thumb down</option>
					<option value="build">Wrench</option>
					<option value="account_circle">Account</option>
					<option value="android">Android</option>
				</select><br/>
			</div>
		</div>
		<a class="fab">
			<i class="material-icons"> file_download </i>
		</a>
		<footer>
			<a href="mailto:lukaas9000@gmail.com">Report a bug or give feedback</a>
		</footer>
	</div>
</body>
</html>
