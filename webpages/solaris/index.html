<!DOCTYPE html>
<html lang="en">
<head>
	<!-- Site info -->
	<title>Solaris</title>
	<meta name="Solaris" content="Solar system simulation by Lucas van Osenbruggen.">
	<meta charset="UTF-8">
	<!-- Favicon by http://realfavicongenerator.net -->
	<link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" href="favicon/favicon-32x32.png" sizes="32x32">
	<link rel="icon" type="image/png" href="favicon/android-chrome-192x192.png" sizes="192x192">
	<link rel="icon" type="image/png" href="favicon/favicon-16x16.png" sizes="16x16">
	<link rel="manifest" href="favicon/manifest.json">
	<link rel="mask-icon" href="favicon/safari-pinned-tab.svg" color="#6b93d6">
	<link rel="shortcut icon" href="favicon/favicon.ico">
	<meta name="msapplication-config" content="favicon/browserconfig.xml">
	<meta name="theme-color" content="#ffffff">
	<!-- Fonts -->
	<link href="https://fonts.googleapis.com/css?family=Noto+Sans|Material+Icons" rel="stylesheet">
	<!-- Load the Paper.js library -->
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/paper.js/0.10.2/paper-full.js"></script>
	<!-- Load the jQuery library -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
	<!--  Js code -->
	<script type="text/paperscript" canvas="canvas">

		paper.install(window); // No accessing through the paper object

		$(document).ready(function()
		{
			paper.setup($('#canvas')[0]); // Selects canvas

			// -- Initial variables --
            var canHeight = view.viewSize.height;
            var canWidth = view.viewSize.width;
			var systemCenter =  new Point((canWidth / 2), (canHeight / 2));

			var sidebarState = "closed";
			var $sidebar = $('.sidebarContainer');
			var $close = $('#sidebar .close');

			var $menu = $("#menu");
			var $menuButton = $(".menuButton");
			var $options = $(".options");

			var musicState = "on";
			var $musicButton = $(".option.music");
			var $music = $("#music");

			var $infoButton = $(".option.about");
			var $info = $(".infoContainer");
			var $overlay = $("#overlay");

			var $orbitButton = $(".option.orbits");

			// -- Website controls --
			// Options visible
			$menuButton.mouseenter(function()
			{
				$menuButton.addClass("active");
				$options.show
				(
					"drop", {direction: "up"}, 400
				);
			});

			$menu.mouseleave(function()
			{
				$options.hide
				(
					"drop",
					{
						direction: "up",
						complete: function()
						{
							$menuButton.removeClass("active");
						}
					},
					400
				);
			});

			// Turns off music
			$musicButton.click(function()
			{
				if (musicState === "on")
				{
					$musicButton.find("i").html("volume_off");
					$music[0].pause();
					musicState = "off";
				}
				else
				{
					$musicButton.find("i").html("volume_up");
					$music[0].play();
					musicState = "on";
				}
			});

			// Shows button
			$sidebar.mouseenter(function()
			{
				$close .fadeIn();
			});
			$sidebar.mouseleave(function()
			{
				$close .fadeOut();
			});

			// Shows info
			$infoButton.click(function()
			{
				if (sidebarState === "opened")
				{
					sidebarOpen(false);
				}
				$overlay.fadeIn();
				$info.fadeIn();
			});

			$overlay.click(function()
			{
				$overlay.fadeOut();
				$info.fadeOut();
			});

			// Closes sidebar
			$close.click(function()
			{
				if (sidebarState === "opened")
				{
					sidebarOpen(false);
				}
			});

			// Toggles sidebar
			$sidebar.css({right: -$sidebar.width()});
			$sidebar.show();

			function sidebarOpen(open)
			{
				if (open)
				{
					$sidebar.animate
					(
						{right: 0},
						{
							duration: setData.time,
							complete: function() {sidebarState = "opened";}
						}
					);
				}
				else
				{
					$sidebar.animate
					(
						{right: -$sidebar.width()},
						{
							duration: setData.time,
							complete: function() {sidebarState = "closed";}
						}
					);
				}
			}

			// Set text of sidebar
			function setData(object)
			{
				var time = 400; // Sets the duration of the sidebar animation
				function print()
				{
					$sidebar.find(".header").css({backgroundColor: object.data.color});
					$sidebar.find(".header h2").text(object.data.name);
					$sidebar.find(".info").empty();
					$sidebar.find(".info").append($("<img/>").attr({alt: "Source: " + object.data.img, src: ("media/planetImgs/" + object.data.name + ".png")}));
					$sidebar.find(".info").append("<br/><br/>");
					$sidebar.find(".info").append("<p>The average surface temperature of " + (object.data.name).toLowerCase() + " is around " + object.data.temperature + " Kelvin or " + (object.data.temperature - 273) + " degrees Celcius.</p>");
					$sidebar.find(".info").append("<br/>");
					$sidebar.find(".info").append("<p>" + object.data.name + " has a mass of " + (object.data.mass).toPrecision(2) + " kilograms.</p>");
					$sidebar.find(".info").append("<p>Its volume is " + (object.data.volume).toPrecision(2) + " square metres.</p>");
					$sidebar.find(".info").append("<p>It has a density of " + Math.round(object.data.density) + " kilogram per square metre.</p>");
					if (object.class === "Planetoid")
					{
						$sidebar.find(".info").append("<br/>");
						$sidebar.find(".info").append("<p>" + object.data.name + " takes " + Math.round(object.data.orbitDuration)  + " days to orbit " + (object.orbits.data.name).toLowerCase() + ".</p>");
						$sidebar.find(".info").append("<p>It travels with an average speed of " + Math.round(object.data.speed)  + " metres per second, relative to " + (object.orbits.data.name).toLowerCase() + ".</p>");
					}
					$sidebar.find(".info").append("<hr/>");
					$sidebar.find(".info").append($("<a>More info</a>").attr({href: ("https://en.wikipedia.org/wiki/" + object.data.name), target: "_blank"}).css({color: object.data.color}));
				}
				if (sidebarState === "closed")
				{
					print();
					sidebarOpen(true);
				}
				else if (sidebarState === "opened")
				{
					sidebarOpen(false);
					setTimeout(print, time); // Changes when out of view
					sidebarOpen(true);
				}
			}

			// -- Constructors --
			// Data constructor
			var Data = function(name, color, img, mass, radius, speed, orbitDuration, temperature)
			{
				this.name = name;
				this.color = color;
				this.img = img;
				this.mass = mass; // kg
				this.radius = radius; // m
				this.volume = ((4 / 3) * Math.PI * Math.pow(this.radius, 3)); // m^3
				this.density = (this.mass / this.volume); // kg/m^3
				this.speed = speed; // m/s
				this.orbitDuration = orbitDuration; // days
				this.orbitLength = (this.speed * (this.orbitDuration * 24 * 60 * 60)); // m
				this.temperature = temperature; // K
			}

			// Space rock constructor
			function SpaceRock(name, orbitRadius, orbits)
			{
				this.orbit = new Path.Circle(systemCenter, orbitRadius);
				this.img = new Raster(name);
				this.orbits = orbits;

				this.img.onFrame = function()
				{
					this.orbiting();
				}.bind(this);
			}

			// Space object constructor
			function SpaceObject()
			{
				/*
				this.tagLabel = new Group(
				[
					this.tag = new Path.Rectangle(
					{
						size: [Math.round(canWidth / 25), Math.round(canHeight / 35)],
						fillColor: "#fafafa"
					}),
					this.label = new PointText(
					{
						position: [this.tag.position.x, (this.tag.position.y + 4)],
						content: this.data.name,
						fillColor: "#757575",
						justification: "center",
						fontFamily: "noto sans"
					})
				]);
				this.tagLabel.visible = false;
				*/
				this.img.onMouseEnter = function()
				{
					$("body").css({cursor: "pointer"});
					// this.tagLabel.visible = true;
				}.bind(this);
				this.img.onMouseLeave = function()
				{
					$("body").css({cursor: "default"});
					// this.tagLabel.visible = false;
				}.bind(this);

				this.img.onClick = function()
				{
					setData(this);
				}.bind(this);
			}

			// Planetoid constructor, is a SpaceObject and a SpaceRock
			function Planetoid(name, orbitRadius, orbits, data)
			{
				this.class = "Planetoid";
				SpaceRock.call(this, name, orbitRadius, orbits);
				this.data = data;
				SpaceObject.call(this);
			}
			Planetoid.prototype = Object.create(SpaceRock.prototype);
			Planetoid.prototype = Object.create(SpaceObject.prototype);

			// Star constructor, is a SpaceObject
			function Star(name, diameter, data)
			{
				this.class = "Star";
				this.img = new Raster(name);
				this.data = data;
				SpaceObject.call(this);

				this.diameter = diameter;

				this.center = new Path.Circle(systemCenter, (this.diameter / 2));
				this.img.set(
				{
					size: [this.diameter, this.diameter],
					position: this.center.position
				});

				// this.tagLabel.position = [this.center.position.x, (this.center.position.y - (this.diameter / 2) - (canHeight / 40))];
			}
			Star.prototype = Object.create(SpaceObject.prototype);

			// Planet constructor, is a Planetoid
			function Planet(name, diameter, orbitRadius, orbits, data)
			{
				Planetoid.call(this, name, orbitRadius, orbits, data);

				this.orbitSpeed = this.data.speed / 200000;
				this.diameter = diameter;

				this.center = new Path.Circle(this.orbit.bounds.leftCenter, (this.diameter / 2));
				this.img.set(
				{
					size: [this.diameter, this.diameter],
					position: this.center.position
				});
			}
			Planet.prototype = Object.create(Planetoid.prototype);

			Planet.prototype.orbiting = function()
			{
				this.center.rotate(this.orbitSpeed, this.orbits.center.position);
				this.img.position = this.center.position;

				// this.tagLabel.position = [this.center.position.x, (this.center.position.y - (this.diameter / 2) - (canHeight / 40))];
			}

			// Moon constructor, is a Planetoid
			function Moon(name, orbitRadius, orbits, data)
			{
				Planetoid.call(this, name, orbitRadius, orbits, data);

				this.orbit.position = this.orbits.center.position;
				this.diameter = Math.round(this.orbits.diameter / (this.orbits.data.radius / this.data.radius));

				this.center = new Path.Circle(this.orbit.bounds.leftCenter, (this.diameter /2));
				this.img.set(
				{
					size: [this.diameter, this.diameter],
					position: this.center.position
				});
			}
			Moon.prototype = Object.create(Planetoid.prototype);

			Moon.prototype.orbiting = function()
			{
				this.center.rotate(this.orbits.orbitSpeed, this.orbits.orbits.center.position);
				this.img.position = this.center.position;

				this.orbit.position = this.orbits.center.position;
				this.center.rotate(this.orbits.orbitSpeed * 11, this.orbit.position);
				this.img.position = this.center.position;

				// this.tagLabel.position = [this.center.position.x, (this.center.position.y - (this.diameter / 2) - (canHeight / 40))];
			}

			function background()
			{
				new Path.Rectangle(
				{
					point: [0, 0],
					size: [canWidth, canHeight],
					fillColor: "#212121"
				});
				var path = new Path.Circle(systemCenter, 3);
				path.fillColor = new Color(1, 0.85);
				var defineStar = new SymbolDefinition(path);
				for (var i = 0; i < 500; i++)
				{
					var star = defineStar.place();
					star.position = (Point.random() * view.viewSize);
					star.scale(0.25 + (Math.random() * 0.75));
				}
			}

			// -- Setup functions --
			// Solar system
			function setupSolarsystem()
			{
				// Sun object
				var sun = new Star
				(
					"sun",
					Math.round(canHeight / 4.5),
					new Data
					(
						"The Sun",
						"#FFAE4C",
						"http://i1-win.softpedia-static.com/screenshots/Sun-Space-Screensaver_1.jpg",
						1.98855e30,
						6.957e8,
						0,
						0,
						5.778e3
					)
				);

				// Planet objects
				var mercury = new Planet
				(
					"mercury",
					Math.round(canHeight / 35),
					Math.round(canWidth / 10),
					sun,
					new Data
					(
						"Mercury",
						"#9db4c0",
						"https://upload.wikimedia.org/wikipedia/commons/d/d9/Mercury_in_color_-_Prockter07-edit1.jpg",
						3.3011e23,
						2.4397e6,
						4.7362e4,
						8.7969e1,
						3.40e2
					)
				);
				var venus = new Planet
				(
					"venus",
					Math.round(canHeight / 25),
					Math.round(canWidth / 7.75),
					sun,
					new Data
					(
						"Venus",
						"#dbae6d",
						"https://upload.wikimedia.org/wikipedia/commons/8/85/Venus_globe.jpg",
						4.8675e24,
						6.0518e6,
						3.502e4,
						2.24701e2,
						7.37e2
					)
				);
				var earth = new Planet
				(
					"earth",
					Math.round(canHeight / 25),
					Math.round(canWidth / 6.1),
					sun,
					new Data
					(
						"Earth",
						"#6b93d6",
						"https://upload.wikimedia.org/wikipedia/commons/6/6f/Earth_Eastern_Hemisphere.jpg",
						5.97237e24,
						6.371e6,
						2.978e4,
						3.65256363004e2,
						2.88e2
					)
				);
				var mars = new Planet
				(
					"mars",
					Math.round(canHeight / 27.5),
					Math.round(canWidth / 4.95),
					sun,
					new Data
					(
						"Mars",
						"#c1440e",
						"https://upload.wikimedia.org/wikipedia/commons/thumb/0/02/OSIRIS_Mars_true_color.jpg/1200px-OSIRIS_Mars_true_color.jpg",
						6.4171e23,
						3.3895e6,
						2.4077e4,
						6.86971e2,
						2.10e2
					)
				);
				var jupiter = new Planet
				(
					"jupiter",
					Math.round(canHeight / 10.5),
					Math.round(canWidth / 3.5),
					sun,
					new Data
					(
						"Jupiter",
						"#d8ca9d",
						"https://upload.wikimedia.org/wikipedia/commons/5/5a/Jupiter_by_Cassini-Huygens.jpg",
						1.8986e27,
						6.9911e7,
						1.307e4,
						4.33259e3,
						1.65e2
					)
				);
				var saturn = new Planet
				(
					"saturn",
					Math.round(canHeight / 10.5),
					Math.round(canWidth / 2.85),
					sun,
					new Data
					(
						"Saturn",
						"#eec87d",
						"https://saturn.jpl.nasa.gov/system/resources/detail_files/7504_PIA21046_MAIN.jpg",
						5.6836e26,
						5.8232e7,
						9.69e3,
						1.075922e4,
						1.34e2
					)
				);
				var uranus = new Planet
				(
					"uranus",
					Math.round(canHeight / 14.5),
					Math.round(canWidth / 2.45),
					sun,
					new Data
					(
						"Uranus",
						"#6BE6E8",
						"https://upload.wikimedia.org/wikipedia/commons/3/3d/Uranus2.jpg",
						8.6810e25,
						2.5362e7,
						6.80e3,
						3.06885e4,
						76
					)
				);
				var neptune = new Planet
				(
					"neptune",
					Math.round(canHeight / 14.5),
					Math.round(canWidth / 2.2),
					sun,
					new Data
					(
						"Neptune",
						"#3f54ba",
						"https://upload.wikimedia.org/wikipedia/commons/thumb/5/56/Neptune_Full.jpg/1200px-Neptune_Full.jpg",
						1.0243e26,
						2.4622e7,
						5.43e3,
						6.0182e4,
						72
					)
				);

				// Moon object
				var moon = new Moon
				(
					"moon",
					Math.round(canWidth / 55),
					earth,
					new Data
					(
						"The Moon",
						"#c1c1c1",
						"https://upload.wikimedia.org/wikipedia/commons/e/e1/FullMoon2010.jpg",
						7.342e22,
						1.7371e6,
						1.022e3,
						2.7321661e1
					)
				);

				// All objects in the canvas
				var solarSystem = [[mercury, venus, earth, mars, jupiter, saturn, uranus, neptune], moon, sun];

				// View invisible paths
				function selected()
				{
					sun.center.selected = true;
					for (var i = 0; i < solarSystem[0].length; i++)
					{
						solarSystem[0][i].center.selected = true;
						solarSystem[0][i].orbit.selected = true;
					}
					moon.center.selected = true;
					moon.orbit.selected = true;
				}

				// selected(); // Shows invisible paths

				console.log("All objects:");
				console.log(solarSystem);
			}

			// -- Actions --
			background(); // Draws stars and sets the background
			setupSolarsystem(); // Sets everything in the solar system

			$("body").animate({opacity: 1}, 1000); // Fade in the screen

			console.log("");
			console.log("-- Welcome to solaris -- ");
		});
	</script>
	<!-- Css code -->
	<style>
		/* -- Global -- */
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box; /* Fixes box sizing problem */
			font-family: 'Noto Sans', sans-serif;
			-webkit-user-select: none;
			-webkit-touch-callout: none;
		}

		body {
			opacity: 0;
			height: 100vh;
			width: 100vw;
			overflow: hidden;
			font-size: 16px; /* Base size */
		}

		:focus, :active {
			outline: none;
		}

        button {
            background-color: transparent;
            border: 0px solid transparent;
			cursor: pointer;
        }

		#overlay {
			background-color: rgba(0, 0, 0, 0.65);
			display: none;
			z-index: 15;
			position: fixed;
			width: 100vw;
			height: 100vh;
		}

		/* -- Canvas -- */
		.canvas { /* .canvas fills screen */
			width: 100vw;
			height: 100vh;
		}

		#canvas {
			display: block;
			z-index: 0;
		}

        #canvas[resize] { /* canvas fills .canvas */
            width: 100%;
            height: 100%;
        }

		.media { display: none; }

		/* -- Sidebar -- */
		.sidebarContainer {
			display: none;
			position: absolute;
            top: 0;
            right: 0
		}

        #sidebar {
            background-color: #f5f5f5;
			box-shadow: 0px 1px 2px rgba(0,0,0,0.2);
			transition: 0.4s;
            height: 90vh;
            width: 20vw;
			position: relative;
            margin: 5vh 2.5vw;
            border-radius: 0.5vh;
			z-index: 10;
        }

		#sidebar:hover {
 			box-shadow: 0px 4px 10px rgba(0,0,0,0.35);
		}

		.close {
			display: none;
			position: absolute;
			margin: 1vw;
			right: 0;
			top: 0;
		}

		.close i {
			font-size: 1.5em;
			color: rgba(255, 255, 255, 0.75);
		}

		.text {
			height: 100%;
		}

		.text h2 {
			text-align: center;
			font-weight: normal;
			font-size: 1.5em;
			color: #ffffff;
			padding: 1.5vw;
		}

		.text .header {
			height: 10%;
		}

		.text .info {
			height: 90%;
			padding: 2vw;
			color: #424242;
			overflow: scroll;
		}

		.text .info a {
			text-decoration: none;
			transition: 0.4s;
		}

		.text .info a:hover {
			text-decoration: underline;
		}

		.text .info img {
			width: 100%;
			border-radius: 0.5vh;
			background-color: #e0e0e0;
		}

		.text .info hr {
			margin: 2vh 0vw;
		}

		/* -- Info -- */
		.infoContainer {
			display: none;
		}

		#info {
			position: absolute;
			margin: 25vh 25vw;
			width: 50vw;
			height: 50vh;
			padding: 2vw;
			z-index: 20;
			border-radius: 0.5vh;
			background-color: #f5f5f5;
			box-shadow: 0px 1px 2px rgba(0,0,0,0.2);
			transition: 0.4s;
		}

		#info:hover {
			box-shadow: 0px 4px 10px rgba(0,0,0,0.35);
		}

		/* -- Menu -- */
		#menu {
			position: absolute;
			margin: 1rem;
		}

		.menuButton {
			padding: 1.5vh;
			height: 7vh;
			width: 7vh;
			margin: 1vh 0vw;
			border-radius: 100%;
			z-index: 10;
			display: block;
			position: relative;
			transition: 0.4s;
			color: #f5f5f5;
		}

		.menuButton i { font-size: 4vh; }

		.menuButton.active {
			background-color: #f5f5f5;
			color: #424242;
			box-shadow: 0px 6px 8px rgba(0,0,0,0.30);
		}

		.options {
			display: none;
			position: absolute;
			margin-top: 6vh;
			top: 2vh;
		}

		.option {
			padding: 1vh;
			height: 5vh;
			width: 5vh;
			margin: 1vh 1vh;
			border-radius: 100%;
			z-index: 5;
			display: block;
			background-color: #eeeeee;
			box-shadow: 0px 4px 4px rgba(0,0,0,0.15);
			transition: 0.4s;
		}

		.option i {
			color: #757575;
			font-size: 3vh;
		}

		.option:hover {
			box-shadow: 0px 6px 8px rgba(0,0,0,0.30);
		}

		.tooltip {
			position: absolute;
			left: 4vw;
			width: 5.5vw;
			padding: 0.5vw;
			font-size: 0.75em;
			border-radius: 0.5vh;
			box-shadow: 0px 4px 4px rgba(0,0,0,0.15);
			background-color: #424242;
			color: #f5f5f5;
			transition: 0.4s;
			opacity: 0;
		}

		.option:hover .tooltip {
			opacity: 1;
		}
	</style>
</head>
<body>
	<div id="overlay"></div>
	<div class="infoContainer">
		<div id="info">
			<p>Made by Lucas van Osenbruggen.</p>
			<br/>
			<p></p>
			<hr/>
			<a href=""></a>
		</div>
	</div>
	<div id="screen">
		<div id="menu">
			<button class="menuButton"><i class="material-icons ">menu</i></button>
			<div class="options">
				<button class="option music"><i class="material-icons ">volume_up</i><span class="tooltip">Toggle music</span></button>
				<button class="option orbits"><i class="material-icons ">filter_tilt_shift</i><span class="tooltip">Toggle orbits</span></button>
				<button class="option about"><i class="material-icons ">info_outline</i><span class="tooltip">Info</span></button>
			</div>
		</div>
	    <div class="canvas">
	        <canvas id="canvas" resize="true"  keepalive="true">
				<button></button>
			</canvas>
	    </div>
		<div class="sidebarContainer">
			<div id="sidebar">
				<button class="close"><i class="material-icons">close</i></button>
				<div class="text">
					<div class="header">
						<h2></h2>
					</div>
					<section class="info">
					</section>
				</div>
			</div>
		</div>
	</div>
	<div class="media">
		<img id="sun" src="media/planetSprites/sun.svg"/>
		<img id="mercury" src="media/planetSprites/mercury.svg"/>
		<img id="venus" src="media/planetSprites/venus.svg"/>
		<img id="earth" src="media/planetSprites/earth.svg"/>
		<img id="moon" src="media/planetSprites/moon.svg"/>
		<img id="mars" src="media/planetSprites/mars.svg"/>
		<img id="ceres" src="media/planetSprites/ceres.svg"/>
		<img id="jupiter" src="media/planetSprites/jupiter.svg"/>
		<img id="saturn" src="media/planetSprites/saturn.svg"/>
		<img id="uranus" src="media/planetSprites/uranus.svg"/>
		<img id="neptune" src="media/planetSprites/neptune.svg"/>
		<img id="pluto" src="media/planetSprites/pluto.svg"/>
		<img id="astroid" src="media/planetSprites/astroid.svg"/>
		<audio id="music" autoplay="true" loop="true" controls="true">
			<source src="media/space.mp3" type="audio/mpeg" alt="Source: https://youtu.be/PRnn_-M-efM"/>
		</audio>
	</div>
</body>
</html>
