<!DOCTYPE html>
<html lang="en">
<head>
	<title>Solaris</title>
	<meta name="Solaris" content="Solar system simulation by Lucas van Osenbruggen.">
	<meta charset="UTF-8">
	<!-- http://realfavicongenerator.net -->
	<link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png">
	<link rel="icon" type="image/png" href="favicon/favicon-32x32.png" sizes="32x32">
	<link rel="icon" type="image/png" href="favicon/android-chrome-192x192.png" sizes="192x192">
	<link rel="icon" type="image/png" href="favicon/favicon-16x16.png" sizes="16x16">
	<link rel="manifest" href="favicon/manifest.json">
	<link rel="mask-icon" href="favicon/safari-pinned-tab.svg" color="#6b93d6">
	<link rel="shortcut icon" href="favicon/favicon.ico">
	<meta name="msapplication-config" content="favicon/browserconfig.xml">
	<meta name="theme-color" content="#ffffff">
	<!-- Load the Paper.js library -->
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/paper.js/0.10.2/paper-full.js"></script>
	<!-- Load the jQuery library -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
	<!-- Fonts -->
	<link href="https://fonts.googleapis.com/css?family=Noto+Sans|Material+Icons" rel="stylesheet">
	<!--  Code -->
	<script type="text/paperscript" canvas="canvas">

		paper.install(window); // No accessing through the paper object

		$(document).ready(function()
		{
			paper.setup($('#canvas')[0]); // Selects canvas

			// Variables
            var canHeight = view.viewSize.height;
            var canWidth = view.viewSize.width;
			var systemCenter =  [(canWidth /2), (canHeight / 2)];
			var planetSpeed = 0.1;

			// Stars
			var star = [ ];
			function stars()
			{
				for (var i = 0; i < 500; i++)
				{
					var radius = (canWidth / 1000 * (Math.random() * 1.5));
					var position = [Math.ceil(Math.random() * canWidth), Math.ceil(Math.random() * canHeight)];
					star[i] = new Path.Circle(position, radius);
					star[i].fillColor = new Color(1, 1, 1, ((Math.random() * 50 + 50) / 100));
				}
			}
			stars();

			// Data constructor
			var Data = function(name, color, mass, radius, age, speed, orbitRadius)
			{
				this.name = name;
				this.mass = mass; // kg
				this.radius = radius; // m
				this.volume = ((4 / 3) * Math.PI * Math.pow(this.radius, 3)); // m^3
				this.density = (this.mass / this.volume); // kg/m^3
				this.age = age; // years
				this.speed = speed; // m/s
				this.orbitRadius = orbitRadius; // m
				this.orbit = (this.orbitRadius * Math.PI * 2); // m
				this.orbitPeriod = ((this.orbit / this.speed) / (24 * 60 * 60)); // days
				this.color = color;
			}

			// Planet constructor
			var Planet = function(name, diameter, orbitRadius, orbitSpeed, data)
			{
				this.diameter = diameter;
				this.orbitSpeed = orbitSpeed;

				this.orbit = new Path.Circle(systemCenter, orbitRadius);
				this.img = new Raster(name);
				this.data = data;
			}
			Planet.prototype.orbiting = function()
			{
				this.center.rotate(this.orbitSpeed, systemCenter);
				this.img.position = this.center.position;
			}
			Planet.prototype.set = function()
			{
				this.center = new Path.Circle(this.orbit.bounds.leftCenter, (this.diameter /2))
				this.img.set(
				{
					size: [this.diameter, this.diameter],
					position: this.center.position
				});
			}

			// Moon constructor
			var Moon = function(name, diameter, orbits, orbitRadius, orbitSpeed, data)
			{
				this.diameter = diameter;
				this.orbits = orbits;
				this.orbitSpeed = orbitSpeed;
				this.orbit = new Path.Circle([0, 0], orbitRadius);
				this.img = new Raster(name);
				this.data = data;
			}
			Moon.prototype.orbiting = function()
			{
				this.center.rotate(this.orbitSpeed, systemCenter);
				this.img.position = this.center.position;
				this.orbit.position = this.orbits.center.position;
				this.center.rotate(this.orbitSpeed + 0.2, this.orbit.position);
				this.img.position = this.center.position;
			}
			Moon.prototype.set = function()
			{
				this.orbit.position = this.orbits.center.position;
				this.center = new Path.Circle(this.orbit.bounds.leftCenter, (this.diameter /2))
				this.img.set(
				{
					size: [this.diameter, this.diameter],
					position: this.center.position
				});
			}

			// Sun object
			var sun =
			{
				diameter: canHeight / 4.5,
				center: systemCenter,
				img: new Raster("sun"),
				set: function()
				{
					this.img.size = [this.diameter, this.diameter];
					this.img.position = this.center;
				},
				data: new Data
				(
					"The Sun",
					"#ffcc4c",
					1.98855e30,
					6.957e8,
					4.6e9,
					0,
					0
				)
			};

			// Planet objects
			var mercury = new Planet
			(
				"mercury",
				(canHeight / 35),
				(canWidth / 10),
				planetSpeed,
				new Data
				(
					"Mercury",
					"#9db4c0"
				)
			);
			var venus = new Planet
			(
				"venus",
				(canHeight / 25),
				(canWidth / 7.75),
				planetSpeed,
				new Data
				(
					"Venus",
					"#dbae6d"
				)
			);
			var earth = new Planet
			(
				"earth",
				(canHeight / 25),
				(canWidth / 6.1),
				planetSpeed,
				new Data
				(
					"Earth",
					"#6b93d6",
					5.97237e24,
					6.371e3,
					4.54e9,
					29.78e3,
					1.496e11
				)
			);
			var mars = new Planet
			(
				"mars",
				(canHeight / 27.5),
				(canWidth / 5),
				planetSpeed,
				new Data
				(
					"Mars",
					"#c1440e"
				)
			);
			var jupiter = new Planet
			(
				"jupiter",
				(canHeight / 10.5),
				(canWidth / 3.5),
				planetSpeed,
				new Data
				(
					"Jupiter",
					"#d8ca9d"
				)
			);
			var saturn = new Planet
			(
				"saturn",
				(canHeight / 10.5),
				(canWidth / 2.85),
				planetSpeed,
				new Data
				(
					"Saturn",
					"#eec87d"
				)
			);
			var uranus = new Planet
			(
				"uranus",
				(canHeight / 14.5),
				(canWidth / 2.45),
				planetSpeed,
				new Data
				(
					"Uranus",
					"#a8f4f6"
				)
			);
			var neptune = new Planet
			(
				"neptune",
				(canHeight / 14.5),
				(canWidth / 2.2),
				planetSpeed,
				new Data
				(
					"Neptune",
					"#3f54ba"
				)
			);

			// Moon object
			var moon = new Moon
			(
				"moon",
				(canHeight / 75),
				earth,
				(canWidth / 55),
				planetSpeed,
				new Data
				(
					"The moon",
					"#e0e0e0"
				)
			);

			// All objects in the canvas
			var solarSystem = [[mercury, venus, earth, mars, jupiter, saturn, uranus, neptune], [moon], sun, star];

			// Sets vars that can't be initialised
			setTimeout(sun.set(), 1);
			for (var i = 0; i < solarSystem[0].length; i++)
			{
				setTimeout(solarSystem[0][i].set(), 1);
				//solarSystem[0][i].orbit.selected = true;
				//solarSystem[0][i].center.selected = true;
			}
			for (var i = 0; i < solarSystem[1].length; i++)
			{
				setTimeout(solarSystem[1][i].set(), 1);
				//solarSystem[1][i].orbit.selected = true;
				//solarSystem[1][i].center.selected = true;
			}

			// The frame event
			view.onFrame = function(event)
			{
				for (var i = 0; i < solarSystem[0].length; i++)
				{
					solarSystem[0][i].orbiting();
				}
				for (var i = 0; i < solarSystem[1].length; i++)
				{
					solarSystem[1][i].orbiting();
				}

			}

			console.log(solarSystem);
		});
	</script>
	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box; /* Fixes box sizing problem */
			font-family: 'Noto Sans', sans-serif;
			-webkit-user-select: none;
			-webkit-touch-callout: none;
		}
		:focus, :active {
			outline: none;
		}
		::-webkit-scrollbar {
			display: none;
		}
		body {
			background-color: #212121;
        }
        button {
            background-color: transparent;
            border: 0px solid transparent;
        }

		.canvas { /* .canvas fills screen */
			width: 100vw;
			height: 100vh;
		}

		#canvas {
			display: block;
		}

        #canvas[resize] { /* canvas fills .canvas */
            width: 100%;
            height: 100%;
        }

		.images { display: none; }
        .sidebar {
			display: none;
            background-color: #eeeeee;
            position: absolute;
            height: 90vh;
            width: 20vw;
            margin: 5vh 2.5vw;
            border-radius: 0.5vh;
            top: 0;
            right: 0;
        }
        .more {
            position: absolute;
            margin: 10px;
            right: 0;
            top: 0;
        }
        .more i {
            font-size: 20px;
            color: rgba(0, 0, 0, 0.65);
        }
	</style>
</head>
<body>
	<div class="screen">
	    <div class="canvas">
	        <canvas id="canvas" resize="true"  keepalive="true">

			</canvas>
	    </div>
		<div class="images">
			<img id="sun" src="media/planetImgs/sun.svg"/>
			<img id="mercury" src="media/planetImgs/mercury.svg"/>
			<img id="venus" src="media/planetImgs/venus.svg"/>
			<img id="earth" src="media/planetImgs/earth.svg"/>
			<img id="moon" src="media/planetImgs/moon.svg"/>
			<img id="mars" src="media/planetImgs/mars.svg"/>
			<img id="ceres" src="media/planetImgs/ceres.svg"/>
			<img id="jupiter" src="media/planetImgs/jupiter.svg"/>
			<img id="saturn" src="media/planetImgs/saturn.svg"/>
			<img id="uranus" src="media/planetImgs/uranus.svg"/>
			<img id="neptune" src="media/planetImgs/neptune.svg"/>
			<img id="pluto" src="media/planetImgs/pluto.svg"/>
			<img id="astroid" src="media/planetImgs/astroid.svg"/>
			<audio type="audio/mpeg" src="media/space.mp3" autoplay="true" loop="true"></audio>
		</div>
	</div>
    <div class="sidebar">
        <button class="more"><i class="material-icons ">more_vert</i></button>
    </div>
</body>
</html>
